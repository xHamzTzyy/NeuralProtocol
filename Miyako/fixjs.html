<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>JS CHECKER</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=JetBrains+Mono:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <style>
        :root {
            --red:#FF2D2D; --red-dim:rgba(255,45,45,0.15); --red-glow:rgba(255,45,45,0.5);
            --red-dark:#cc1a1a; --bg:#060101; --surface:rgba(18,4,4,0.85);
            --border:rgba(255,45,45,0.2); --text:#fff; --text-dim:#7a6060;
            --success:#00e676; --success-dim:rgba(0,230,118,0.1);
            --font-title:'Orbitron',sans-serif; --font-code:'JetBrains Mono',monospace;
        }
        *{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
        html,body{height:100%;overflow-x:hidden}
        body{background:var(--bg);color:var(--text);font-family:var(--font-code);min-height:100vh;display:flex;flex-direction:column;align-items:center;padding:30px 20px 130px;position:relative}
        body::before{content:'';position:fixed;inset:0;background-image:linear-gradient(rgba(255,45,45,0.03) 1px,transparent 1px),linear-gradient(90deg,rgba(255,45,45,0.03) 1px,transparent 1px);background-size:40px 40px;z-index:0;pointer-events:none}
        body::after{content:'';position:fixed;top:-20%;left:50%;transform:translateX(-50%);width:600px;height:600px;background:radial-gradient(circle,rgba(255,45,45,0.08) 0%,transparent 70%);z-index:0;pointer-events:none}
        #particles{position:fixed;inset:0;z-index:0;pointer-events:none;overflow:hidden}
        .p{position:absolute;width:2px;height:2px;background:var(--red);border-radius:50%;animation:floatUp linear infinite;opacity:0}
        @keyframes floatUp{0%{transform:translateY(100vh);opacity:0}10%{opacity:0.5}90%{opacity:0.5}100%{transform:translateY(-10vh);opacity:0}}
        .wrapper{position:relative;z-index:2;width:100%;max-width:500px;display:flex;flex-direction:column;gap:16px}

        .page-header{text-align:center;padding:10px 0 5px;animation:fadeDown 0.6s ease forwards}
        .header-eyebrow{font-size:10px;letter-spacing:5px;color:var(--text-dim);margin-bottom:8px}
        .header-title{font-family:var(--font-title);font-size:2rem;font-weight:900;letter-spacing:6px;color:var(--red);text-shadow:0 0 30px var(--red-glow),0 0 60px rgba(255,45,45,0.2)}
        .header-line{width:60px;height:2px;background:linear-gradient(90deg,transparent,var(--red),transparent);margin:10px auto 0}

        .banner{width:100%;height:140px;border-radius:20px;overflow:hidden;border:1px solid var(--border);position:relative;animation:fadeUp 0.6s 0.1s ease both}
        .banner img{width:100%;height:100%;object-fit:cover;filter:brightness(0.6) saturate(0.8)}
        .banner-overlay{position:absolute;inset:0;background:linear-gradient(135deg,rgba(255,45,45,0.15) 0%,transparent 60%)}
        .banner-badge{position:absolute;bottom:14px;left:16px;background:rgba(0,0,0,0.7);backdrop-filter:blur(10px);border:1px solid var(--border);border-radius:8px;padding:6px 12px;font-size:10px;letter-spacing:2px;color:var(--red);font-family:var(--font-title)}
        .shortcut-badge{position:absolute;bottom:14px;right:16px;background:rgba(0,0,0,0.7);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,0.08);border-radius:8px;padding:6px 10px;font-size:9px;color:#555;display:flex;align-items:center;gap:5px}
        .skey{background:rgba(255,255,255,0.08);border:1px solid rgba(255,255,255,0.15);border-radius:4px;padding:1px 5px;font-size:8px;color:#777}

        .stats-row{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;animation:fadeUp 0.6s 0.15s ease both}
        .stat-box{background:var(--surface);border:1px solid var(--border);border-radius:16px;padding:14px 8px;text-align:center}
        .stat-val{font-family:var(--font-title);font-size:1.3rem;color:var(--red);text-shadow:0 0 10px var(--red-glow)}
        .stat-lbl{font-size:7px;color:var(--text-dim);letter-spacing:1px;margin-top:4px;text-transform:uppercase}

        .card{background:var(--surface);backdrop-filter:blur(20px);border:1px solid var(--border);border-radius:24px;padding:22px;box-shadow:0 20px 40px rgba(0,0,0,0.6),inset 0 1px 0 rgba(255,255,255,0.05);animation:fadeUp 0.6s 0.2s ease both}
        .card-label{font-size:9px;letter-spacing:3px;color:var(--text-dim);margin-bottom:12px;display:flex;align-items:center;gap:8px}
        .card-label::before{content:'';width:16px;height:1px;background:var(--red)}

        .toolbar{display:flex;gap:8px;margin-bottom:12px;flex-wrap:wrap}
        .tool-btn{background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.08);border-radius:8px;padding:7px 12px;color:#888;font-family:var(--font-code);font-size:10px;cursor:pointer;transition:0.2s;display:flex;align-items:center;gap:6px;letter-spacing:1px}
        .tool-btn:hover{background:var(--red-dim);border-color:var(--red);color:var(--red)}
        .tool-btn.danger:hover{background:rgba(255,69,58,0.15);border-color:#ff453a;color:#ff453a}

        .editor-wrapper{position:relative;margin-bottom:12px}
        .editor-header{display:flex;align-items:center;justify-content:space-between;background:rgba(0,0,0,0.4);border:1px solid var(--border);border-bottom:none;border-radius:14px 14px 0 0;padding:10px 16px}
        .editor-dots{display:flex;gap:6px}
        .editor-dots span{width:10px;height:10px;border-radius:50%}
        .dot-r{background:#ff5f57}.dot-y{background:#febc2e}.dot-g{background:#28c840}
        .editor-lang{font-size:10px;color:var(--text-dim);letter-spacing:2px}
        .line-nums{position:absolute;left:0;top:45px;bottom:0;width:36px;background:rgba(0,0,0,0.3);border-right:1px solid rgba(255,45,45,0.1);border-radius:0 0 0 14px;padding:12px 0;display:flex;flex-direction:column;align-items:center;z-index:1;overflow:hidden}
        .line-num{font-size:10px;color:var(--text-dim);line-height:21px;width:100%;text-align:center}
        textarea{width:100%;height:200px;background:rgba(0,0,0,0.5);border:1px solid var(--border);border-top:none;border-radius:0 0 14px 14px;padding:12px 14px 12px 44px;color:#ff9a9a;font-family:var(--font-code);font-size:13px;line-height:21px;outline:none;resize:none;transition:0.3s;caret-color:var(--red)}
        textarea:focus{border-color:rgba(255,45,45,0.5);box-shadow:0 0 20px rgba(255,45,45,0.08)}
        textarea::placeholder{color:#3a2020}

        .counter-bar{display:flex;justify-content:flex-end;gap:16px;padding:6px 2px 0}
        .counter-item{font-size:10px;color:var(--text-dim);display:flex;align-items:center;gap:4px}

        .exec-btn{width:100%;padding:15px;background:linear-gradient(135deg,var(--red) 0%,var(--red-dark) 100%);border:none;border-radius:14px;color:#fff;font-family:var(--font-title);font-size:11px;font-weight:700;letter-spacing:3px;cursor:pointer;transition:0.3s;position:relative;overflow:hidden;box-shadow:0 8px 25px rgba(255,45,45,0.3);margin-top:14px}
        .exec-btn::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,0.1),transparent);transition:0.5s}
        .exec-btn:hover::before{left:100%}
        .exec-btn:hover{transform:translateY(-2px);box-shadow:0 12px 35px rgba(255,45,45,0.4)}
        .exec-btn:active{transform:scale(0.98)}
        .exec-btn i{margin-right:8px}

        .output-section{animation:fadeUp 0.6s 0.25s ease both}
        .output-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px}
        .output-label{font-size:9px;letter-spacing:3px;color:var(--text-dim);display:flex;align-items:center;gap:8px}
        .output-label::before{content:'';width:16px;height:1px;background:var(--red)}
        .output-actions{display:flex;gap:8px}
        .out-btn{background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.08);border-radius:8px;padding:5px 10px;color:#666;font-size:10px;cursor:pointer;transition:0.2s;font-family:var(--font-code)}
        .out-btn:hover{background:var(--red-dim);border-color:var(--red);color:var(--red)}
        .output-card{border-radius:16px;padding:18px 20px;font-size:13px;line-height:1.6;border:1px solid transparent;transition:all 0.4s ease;display:none}
        .output-card.show{display:block;animation:fadeUp 0.4s ease both}
        .output-card.success{background:var(--success-dim);border-color:rgba(0,230,118,0.3);color:var(--success)}
        .output-card.error{background:var(--red-dim);border-color:rgba(255,45,45,0.3);color:#ff8a8a}
        .output-card.collapsed{max-height:56px;overflow:hidden}
        .output-top{display:flex;align-items:center;gap:10px;margin-bottom:8px}
        .output-icon{font-size:1.2rem}
        .output-title{font-family:var(--font-title);font-size:11px;letter-spacing:2px;flex:1}
        .err-badge{font-size:9px;padding:2px 8px;border-radius:6px;background:rgba(255,45,45,0.15);border:1px solid rgba(255,45,45,0.3);letter-spacing:1px}
        .output-msg{font-size:12px;opacity:0.8;word-break:break-all}
        .exec-time{font-size:10px;color:#555;margin-top:5px}

        .history-section{animation:fadeUp 0.6s 0.3s ease both}
        .hist-label{font-size:9px;letter-spacing:3px;color:var(--text-dim);display:flex;align-items:center;gap:8px;margin-bottom:10px}
        .hist-label::before{content:'';width:16px;height:1px;background:var(--red)}
        .hist-item{background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.05);border-radius:12px;padding:11px 15px;cursor:pointer;transition:0.2s;display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
        .hist-item:hover{background:var(--red-dim);border-color:var(--red)}
        .hist-preview{font-size:11px;color:#888;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;flex:1;font-family:var(--font-code)}
        .hist-meta{font-size:10px;color:#555;margin-left:10px;white-space:nowrap;display:flex;align-items:center;gap:6px}
        .hist-dot{width:6px;height:6px;border-radius:50%}
        .hist-dot.ok{background:var(--success)}.hist-dot.err{background:var(--red)}

        .nav-bar{position:fixed;bottom:20px;left:50%;transform:translateX(-50%);display:flex;gap:30px;background:linear-gradient(135deg,rgba(255,255,255,0.1) 0%,rgba(255,45,45,0.06) 50%,rgba(255,255,255,0.04) 100%);backdrop-filter:blur(30px) saturate(180%);-webkit-backdrop-filter:blur(30px) saturate(180%);padding:12px 25px;border-radius:30px;border-top:1px solid rgba(255,255,255,0.35);border-left:1px solid rgba(255,255,255,0.25);border-bottom:1px solid rgba(255,45,45,0.1);border-right:1px solid rgba(255,45,45,0.1);box-shadow:0 8px 32px rgba(0,0,0,0.5),inset 0 1px 0 rgba(255,255,255,0.25),inset 0 -1px 0 rgba(255,45,45,0.08);z-index:999}
        .nav-item{color:rgba(255,255,255,0.4);text-decoration:none;font-size:9px;font-family:var(--font-title);letter-spacing:1px;display:flex;flex-direction:column;align-items:center;gap:5px;transition:0.3s}
        .nav-item i{font-size:1.2rem}
        .nav-item.active,.nav-item:hover{color:var(--red);filter:drop-shadow(0 0 6px var(--red-glow))}

        .toast-notif{position:fixed;top:20px;right:20px;background:rgba(20,5,5,0.95);border:1px solid var(--red);border-radius:12px;padding:11px 16px;color:#fff;font-size:11px;z-index:9999;animation:slideIn 0.3s ease;box-shadow:0 5px 20px rgba(255,45,45,0.3);display:flex;align-items:center;gap:8px;font-family:var(--font-title);letter-spacing:1px}
        @keyframes slideIn{from{transform:translateX(100px);opacity:0}to{transform:translateX(0);opacity:1}}
        @keyframes fadeDown{from{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}
        @keyframes fadeUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
    </style>
</head>
<body>
<div id="particles"></div>

<div class="wrapper">

    <div class="page-header">
        <div class="header-eyebrow">NEURAL PROTOCOL — DEVTOOLS</div>
        <div class="header-title">JS CHECKER</div>
        <div class="header-line"></div>
    </div>

    <div class="banner">
        <img src="https://i.top4top.io/p_3648647u41.jpg" alt="Banner">
        <div class="banner-overlay"></div>
        <div class="banner-badge"><i class="fas fa-code"></i>&nbsp; JAVASCRIPT ENGINE</div>
        <div class="shortcut-badge">
            <span class="skey">Ctrl</span>+<span class="skey">Enter</span> RUN
            &nbsp;|&nbsp;
            <span class="skey">Ctrl</span>+<span class="skey">K</span> CLEAR
        </div>
    </div>

    <div class="stats-row">
        <div class="stat-box"><div class="stat-val" id="checkCount">0</div><div class="stat-lbl">CHECKS</div></div>
        <div class="stat-box"><div class="stat-val" id="errorCount">0</div><div class="stat-lbl">ERRORS</div></div>
        <div class="stat-box"><div class="stat-val" id="lastTime">—</div><div class="stat-lbl">LAST MS</div></div>
        <div class="stat-box"><div class="stat-val" id="histCount">0</div><div class="stat-lbl">HISTORY</div></div>
    </div>

    <div class="card">
        <div class="card-label">INPUT CODE</div>
        <div class="toolbar">
            <button class="tool-btn" onclick="formatCode()"><i class="fas fa-indent"></i> FORMAT</button>
            <button class="tool-btn" onclick="minifyCode()"><i class="fas fa-compress-alt"></i> MINIFY</button>
            <button class="tool-btn danger" onclick="clearAll()"><i class="fas fa-trash"></i> CLEAR</button>
        </div>
        <div class="editor-wrapper">
            <div class="editor-header">
                <div class="editor-dots"><span class="dot-r"></span><span class="dot-y"></span><span class="dot-g"></span></div>
                <div class="editor-lang">JAVASCRIPT</div>
            </div>
            <div class="line-nums" id="lineNums"></div>
            <textarea id="codeInput" spellcheck="false" placeholder="// Paste your JavaScript here...
// Ctrl+Enter to run | Ctrl+K to clear

const greet = name => \`Hello, \${name}!\`;
console.log(greet('World'));
return 42;"></textarea>
        </div>
        <div class="counter-bar">
            <div class="counter-item"><i class="fas fa-text-width" style="font-size:9px"></i>&nbsp;<span id="charCount">0</span> CHARS</div>
            <div class="counter-item"><i class="fas fa-list-ol" style="font-size:9px"></i>&nbsp;<span id="lineCount">1</span> LINES</div>
        </div>
        <button class="exec-btn" id="execBtn" onclick="runCheck()">
            <i class="fas fa-play"></i> EXECUTE CODE
        </button>
    </div>

    <div class="output-section" id="outputSection" style="display:none">
        <div class="output-header">
            <div class="output-label">OUTPUT</div>
            <div class="output-actions">
                <button class="out-btn" onclick="copyResult()"><i class="fas fa-copy"></i> COPY</button>
                <button class="out-btn" onclick="toggleOutput()" id="toggleBtn"><i class="fas fa-chevron-up"></i></button>
            </div>
        </div>
        <div class="output-card" id="output"></div>
    </div>

    <div class="history-section" id="historySection" style="display:none">
        <div class="hist-label">RECENT HISTORY</div>
        <div id="historyList"></div>
    </div>

</div>

<nav class="nav-bar">
    <a href="/dashboard" class="nav-item"><i class="fa-solid fa-house"></i>HOME</a>
    <a href="/tools" class="nav-item active"><i class="fa-solid fa-screwdriver-wrench"></i>TOOLS</a>
    <a href="/profile" class="nav-item"><i class="fa-solid fa-circle-user"></i>PROFILE</a>
</nav>

<script>
    // particles
    const pCont = document.getElementById('particles');
    for (let i = 0; i < 25; i++) {
        const p = document.createElement('div');
        p.className = 'p';
        p.style.left = Math.random() * 100 + 'vw';
        p.style.width = p.style.height = (Math.random() * 2 + 1) + 'px';
        p.style.animationDuration = (Math.random() * 8 + 6) + 's';
        p.style.animationDelay = (Math.random() * 8) + 's';
        pCont.appendChild(p);
    }

    const ta = document.getElementById('codeInput');
    let checks = 0, errors = 0, history = [], lastOutput = '', collapsed = false;

    function updateEditor() {
        const lines = ta.value.split('\n');
        document.getElementById('lineNums').innerHTML = Array.from({length: Math.max(lines.length, 8)}, (_, i) => `<div class="line-num">${i+1}</div>`).join('');
        document.getElementById('charCount').textContent = ta.value.length;
        document.getElementById('lineCount').textContent = lines.length;
    }
    ta.addEventListener('input', updateEditor);
    updateEditor();

    function escHtml(s) { return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;'); }

    function toast(msg, icon='check') {
        const t = document.createElement('div');
        t.className = 'toast-notif';
        t.innerHTML = `<i class="fas fa-${icon}"></i> ${msg}`;
        document.body.appendChild(t);
        setTimeout(() => { t.style.opacity='0'; t.style.transition='0.4s'; }, 2000);
        setTimeout(() => t.remove(), 2500);
    }

    function formatCode() {
        if (!ta.value.trim()) return toast('Kode kosong!', 'triangle-exclamation');
        let indent = 0;
        ta.value = ta.value.split('\n').map(line => {
            const t = line.trim();
            if (!t) return '';
            if (t.match(/^[}\])]/) ) indent = Math.max(0, indent - 1);
            const out = '    '.repeat(indent) + t;
            if (t.match(/[{[(]\s*$/) ) indent++;
            return out;
        }).join('\n');
        updateEditor();
        toast('Code formatted!', 'indent');
    }

    function minifyCode() {
        if (!ta.value.trim()) return toast('Kode kosong!', 'triangle-exclamation');
        ta.value = ta.value
            .replace(/\/\/[^\n]*/g, '')
            .replace(/\/\*[\s\S]*?\*\//g, '')
            .replace(/\s+/g, ' ')
            .replace(/\s*([{}();,=+\-*\/<>!&|?:])\s*/g, '$1')
            .trim();
        updateEditor();
        toast('Code minified!', 'compress-alt');
    }

    function clearAll() {
        ta.value = '';
        updateEditor();
        document.getElementById('output').className = 'output-card';
        document.getElementById('outputSection').style.display = 'none';
        document.getElementById('historySection').style.display = 'none';
        history = [];
        document.getElementById('histCount').textContent = 0;
        lastOutput = '';
        toast('Cleared!', 'trash');
    }

    function getErrType(e) {
        const n = (e.constructor && e.constructor.name) || e.name || 'Error';
        const colors = { SyntaxError:'#ff9a9a', ReferenceError:'#ffb347', TypeError:'#ffd700', RangeError:'#ff69b4', URIError:'#87ceeb', EvalError:'#dda0dd' };
        return { name: n, color: colors[n] || '#ff8a8a' };
    }

    function addHistory(code, success, ms) {
        const preview = code.replace(/\s+/g,' ').trim().substring(0,60) + (code.length > 60 ? '…' : '');
        history.unshift({ code, preview, success, ms, time: new Date().toLocaleTimeString('id-ID',{hour:'2-digit',minute:'2-digit'}) });
        if (history.length > 8) history.pop();
        document.getElementById('histCount').textContent = history.length;
        renderHistory();
    }

    function renderHistory() {
        const list = document.getElementById('historyList');
        const sec = document.getElementById('historySection');
        if (!history.length) { sec.style.display='none'; return; }
        sec.style.display = 'block';
        list.innerHTML = history.map((h,i) => `
            <div class="hist-item" onclick="loadHistory(${i})">
                <span class="hist-preview">${escHtml(h.preview)}</span>
                <div class="hist-meta">
                    <div class="hist-dot ${h.success?'ok':'err'}"></div>
                    ${h.ms}ms · ${h.time}
                </div>
            </div>`).join('');
    }

    function loadHistory(i) {
        ta.value = history[i].code;
        updateEditor();
        toast('History loaded!', 'clock-rotate-left');
    }

    function copyResult() {
        if (!lastOutput) return toast('Ga ada output!', 'xmark');
        navigator.clipboard.writeText(lastOutput).then(() => toast('Copied!','copy')).catch(() => {
            const tmp = document.createElement('textarea');
            tmp.value = lastOutput;
            document.body.appendChild(tmp);
            tmp.select();
            document.execCommand('copy');
            tmp.remove();
            toast('Copied!','copy');
        });
    }

    function toggleOutput() {
        const out = document.getElementById('output');
        const btn = document.getElementById('toggleBtn');
        collapsed = !collapsed;
        out.classList.toggle('collapsed', collapsed);
        btn.innerHTML = collapsed ? '<i class="fas fa-chevron-down"></i>' : '<i class="fas fa-chevron-up"></i>';
    }

    function runCheck() {
        const input = ta.value.trim();
        const output = document.getElementById('output');
        const outputSection = document.getElementById('outputSection');

        if (!input) {
            outputSection.style.display = 'block';
            output.className = 'output-card show error';
            output.innerHTML = `<div class="output-top"><div class="output-icon">⚠️</div><div class="output-title">EMPTY INPUT</div></div><div class="output-msg">Masukkan kode JavaScript dulu.</div>`;
            return;
        }

        checks++;
        document.getElementById('checkCount').textContent = checks;

        const btn = document.getElementById('execBtn');
        btn.innerHTML = '<i class="fas fa-circle-notch fa-spin"></i> EXECUTING...';
        btn.disabled = true;

        const t0 = performance.now();

        setTimeout(() => {
            const logs = [];
            const oLog = console.log, oErr = console.error, oWarn = console.warn;
            console.log = (...a) => logs.push({type:'log', msg:a.map(x=>{ try{return typeof x==='object'?JSON.stringify(x,null,2):String(x);}catch{return String(x);} }).join(' ')});
            console.error = (...a) => logs.push({type:'error', msg:a.map(String).join(' ')});
            console.warn = (...a) => logs.push({type:'warn', msg:a.map(String).join(' ')});

            let result, execError = null;
            try { result = new Function(input)(); }
            catch(e) { execError = e; errors++; document.getElementById('errorCount').textContent = errors; }

            console.log = oLog; console.error = oErr; console.warn = oWarn;

            const ms = Math.round(performance.now() - t0);
            document.getElementById('lastTime').textContent = ms;
            addHistory(input, !execError, ms);

            const logHtml = logs.length ? `
                <div style="margin-top:12px;border-top:1px solid rgba(255,255,255,0.06);padding-top:12px;">
                    <div style="font-size:9px;letter-spacing:2px;color:#555;margin-bottom:8px;">CONSOLE OUTPUT</div>
                    ${logs.map(l=>`
                        <div style="display:flex;gap:8px;margin-bottom:6px;align-items:flex-start;">
                            <span style="color:${l.type==='error'?'#ff6b6b':l.type==='warn'?'#ffcc00':'#555'};font-size:10px;margin-top:1px;"><i class="fas fa-${l.type==='error'?'circle-xmark':l.type==='warn'?'triangle-exclamation':'chevron-right'}"></i></span>
                            <span style="color:${l.type==='error'?'#ff8a8a':l.type==='warn'?'#ffdf80':'#ccc'};font-size:12px;word-break:break-all;white-space:pre-wrap;font-family:var(--font-code);">${escHtml(l.msg)}</span>
                        </div>`).join('')}
                </div>` : '';

            const retHtml = (result !== undefined && !execError) ? `
                <div style="margin-top:12px;border-top:1px solid rgba(255,255,255,0.06);padding-top:12px;">
                    <div style="font-size:9px;letter-spacing:2px;color:#555;margin-bottom:8px;">RETURN VALUE</div>
                    <div style="color:#a8ff8a;font-size:12px;word-break:break-all;white-space:pre-wrap;font-family:var(--font-code);">${escHtml(typeof result==='object'?JSON.stringify(result,null,2):String(result))}</div>
                </div>` : '';

            outputSection.style.display = 'block';
            collapsed = false;
            output.classList.remove('collapsed');
            document.getElementById('toggleBtn').innerHTML = '<i class="fas fa-chevron-up"></i>';

            if (execError) {
                const et = getErrType(execError);
                lastOutput = `[${et.name}] ${execError.message}`;
                output.className = 'output-card show error';
                output.innerHTML = `
                    <div class="output-top">
                        <div class="output-icon">❌</div>
                        <div class="output-title">RUNTIME ERROR</div>
                        <span class="err-badge" style="color:${et.color};border-color:${et.color};">${et.name}</span>
                    </div>
                    <div class="output-msg">${escHtml(execError.message)}</div>
                    <div class="exec-time"><i class="fas fa-clock"></i> ${ms}ms</div>
                    ${logHtml}`;
            } else {
                lastOutput = [...logs.map(l=>l.msg), result!==undefined?'Return: '+String(result):''].filter(Boolean).join('\n') || 'No output';
                const hasOut = logs.length > 0 || result !== undefined;
                output.className = 'output-card show success';
                output.innerHTML = `
                    <div class="output-top">
                        <div class="output-icon">✅</div>
                        <div class="output-title">EXECUTED OK</div>
                    </div>
                    <div class="output-msg">${hasOut ? 'Kode jalan, ini hasilnya:' : 'Kode jalan tapi ga ada output.'}</div>
                    <div class="exec-time"><i class="fas fa-clock"></i> ${ms}ms</div>
                    ${logHtml}${retHtml}`;
            }

            btn.innerHTML = '<i class="fas fa-play"></i> EXECUTE CODE';
            btn.disabled = false;
        }, 300);
    }

    document.addEventListener('keydown', e => {
        if ((e.ctrlKey||e.metaKey) && e.key==='Enter') { e.preventDefault(); runCheck(); }
        if ((e.ctrlKey||e.metaKey) && e.key==='k') { e.preventDefault(); clearAll(); }
    });
</script>
</body>
</html>